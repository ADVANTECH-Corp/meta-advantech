From fadd0ce07f661e0344a4f72fa258102da340c84f Mon Sep 17 00:00:00 2001
From: Your Name <you@example.com>
Date: Thu, 14 Jan 2016 15:12:03 +0800
Subject: [PATCH] Read GPIO_DR instead of GPIO_PSR


diff --git a/drivers/gpio/gpio-mxc.c b/drivers/gpio/gpio-mxc.c
old mode 100644
new mode 100755
index db83b3c..a12ffb5
--- a/drivers/gpio/gpio-mxc.c
+++ b/drivers/gpio/gpio-mxc.c
@@ -447,10 +447,18 @@ static int mxc_gpio_probe(struct platform_device *pdev)
 		}
 	}
 
+#ifdef CONFIG_ARCH_ADVANTECH
+	err = bgpio_init(&port->bgc, &pdev->dev, 4,
+			 port->base + GPIO_DR,
+			 port->base + GPIO_DR, NULL,
+			 port->base + GPIO_GDIR, NULL, 0);
+#else
 	err = bgpio_init(&port->bgc, &pdev->dev, 4,
 			 port->base + GPIO_PSR,
 			 port->base + GPIO_DR, NULL,
 			 port->base + GPIO_GDIR, NULL, 0);
+#endif
+
 	if (err)
 		goto out_bgio;
 
-- 
1.7.9.5

